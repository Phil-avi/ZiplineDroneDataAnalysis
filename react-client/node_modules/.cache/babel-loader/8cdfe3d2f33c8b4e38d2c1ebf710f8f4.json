{"ast":null,"code":"var _jsxFileName = \"/Users/oliverxu/Desktop/CS/BGI/client-react/ecom-client/src/components/home/HomePage.jsx\";\nimport React from 'react';\nimport UserService from '../../services/user.service';\nimport { User } from '../../models/user';\nimport { Transaction } from '../../models/transaction';\n\nclass HomePage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      products: [],\n      errorMessage: '',\n      infoMessage: '',\n      currentUser: new User()\n    };\n  }\n\n  componentDidMount() {\n    UserService.currentUser.subscribe(data => {\n      this.setState({\n        currentUser: data\n      });\n    });\n    this.setState({\n      products: {\n        loading: true\n      }\n    });\n    UserService.findAllProducts().then(products => {\n      this.setState({\n        products: products.data\n      });\n    });\n  }\n\n  purchaseProduct(product) {\n    if (!this.state.currentUser) {\n      this.setState({\n        errorMessage: \"You should sign in to purchase a product\"\n      });\n      return;\n    }\n\n    var transaction = new Transaction(this.state.currentUser, product);\n    UserService.purchaseProduct(transaction).then(data => {\n      this.setState({\n        infoMessage: \"Mission is completed.\"\n      });\n    }, error => {\n      this.setState({\n        errorMessage: \"Unexpected error occurred.\"\n      });\n    });\n  }\n\n  detail(product) {\n    localStorage.setItem('currentProduct', JSON.stringify(product));\n    this.props.history.push('/detail/' + product.id);\n  }\n\n  render() {\n    const _this$state = this.state,\n          products = _this$state.products,\n          infoMessage = _this$state.infoMessage,\n          errorMessage = _this$state.errorMessage;\n    return React.createElement(\"div\", {\n      className: \"col-md-12\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, infoMessage && React.createElement(\"div\", {\n      className: \"alert alert-success\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    }, \"Successfull! \"), \" \", infoMessage, React.createElement(\"button\", {\n      type: \"button\",\n      className: \"close\",\n      \"data-dismiss\": \"alert\",\n      \"aria-label\": \"Close\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }, \"\\xD7\"))), errorMessage && React.createElement(\"div\", {\n      className: \"alert alert-danger\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }, \"Error! \"), \" \", errorMessage, React.createElement(\"button\", {\n      type: \"button\",\n      className: \"close\",\n      \"data-dismiss\": \"alert\",\n      \"aria-label\": \"Close\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, \"\\xD7\"))), products.loading && React.createElement(\"em\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, \" Loading products...\"), products.length && React.createElement(\"table\", {\n      className: \"table table-striped\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, \"#\"), React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }, \"Name\"), React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, \"Price\"), React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, \"Detail\"), React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, \"Action\"))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, products.map((product, index) => React.createElement(\"tr\", {\n      key: product.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      scope: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91\n      },\n      __self: this\n    }, index + 1), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, product.name), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, '$ ' + product.price), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn btn-info\",\n      onClick: () => this.detail(product),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, \"Detail\")), React.createElement(\"td\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn btn-success\",\n      onClick: () => this.purchaseProduct(product),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \"Purchase\")))))));\n  }\n\n}\n\nexport { HomePage };","map":{"version":3,"sources":["/Users/oliverxu/Desktop/CS/BGI/client-react/ecom-client/src/components/home/HomePage.jsx"],"names":["React","UserService","User","Transaction","HomePage","Component","constructor","props","state","products","errorMessage","infoMessage","currentUser","componentDidMount","subscribe","data","setState","loading","findAllProducts","then","purchaseProduct","product","transaction","error","detail","localStorage","setItem","JSON","stringify","history","push","id","render","length","map","index","name","price"],"mappings":"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","sourcesContent":["import React from 'react';\nimport UserService from '../../services/user.service';\nimport {User} from '../../models/user';\nimport {Transaction} from '../../models/transaction';\n\nclass HomePage extends React.Component{\n\n  constructor(props){\n    super(props);\n\n    this.state = {\n      products: [],\n      errorMessage: '',\n      infoMessage: '',\n      currentUser: new User(),\n    };\n  }\n\n  componentDidMount() {\n    UserService.currentUser.subscribe(data =>{\n      this.setState({\n        currentUser: data\n      })\n    });\n\n    this.setState({\n      products: {loading: true}\n    });\n\n    UserService.findAllProducts().\n      then(products => {\n        this.setState({products: products.data});\n      });\n  }\n\n  purchaseProduct(product) {\n    if(!this.state.currentUser){\n      this.setState({errorMessage: \"You should sign in to purchase a product\"});\n      return;\n    }\n\n    var transaction = new Transaction(this.state.currentUser, product);\n    UserService.purchaseProduct(transaction)\n      .then(data => {\n        this.setState({infoMessage: \"Mission is completed.\"});\n      },error => {\n        this.setState({errorMessage: \"Unexpected error occurred.\"});\n      });\n  }\n\n  detail(product) {\n    localStorage.setItem('currentProduct', JSON.stringify(product));\n    this.props.history.push('/detail/'+product.id);\n  }\n\n  render() {\n    const {products, infoMessage, errorMessage} = this.state;\n    return (\n      <div className=\"col-md-12\">\n      {infoMessage &&\n        <div className=\"alert alert-success\">\n          <strong>Successfull! </strong> {infoMessage}\n          <button type=\"button\" className=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n        </div>\n      }\n      {errorMessage &&\n        <div className=\"alert alert-danger\">\n          <strong>Error! </strong> {errorMessage}\n          <button type=\"button\" className=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n        </div>\n      }\n      {products.loading && <em> Loading products...</em>}\n      {products.length &&\n        <table className=\"table table-striped\">\n          <thead>\n            <tr>\n              <th scope=\"col\">#</th>\n              <th scope=\"col\">Name</th>\n              <th scope=\"col\">Price</th>\n              <th scope=\"col\">Detail</th>\n              <th scope=\"col\">Action</th>\n            </tr>\n          </thead>\n          <tbody>\n            {products.map((product, index) =>\n                <tr key={product.id}>\n                  <th scope=\"row\">{index + 1}</th>\n                  <td>{product.name}</td>\n                  <td>{'$ ' + product.price}</td>\n                  <td>\n                    <button className=\"btn btn-info\" onClick={() => this.detail(product)}>Detail</button>\n                  </td>\n                  <td>\n                    <button className=\"btn btn-success\" onClick={() => this.purchaseProduct(product)}>Purchase</button>\n                  </td>\n                </tr>\n            )\n            }\n          </tbody>\n        </table>\n      }\n      </div>\n    );\n  }\n\n}\n\nexport {HomePage};\n"]},"metadata":{},"sourceType":"module"}